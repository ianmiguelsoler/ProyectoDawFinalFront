<VirtualHost *:80>
    ServerName peliculasian.chickenkiller.com
    ServerAlias peliculasian.mooo.com
    DocumentRoot /var/www/html

    # âœ… Especificar pÃ¡gina de inicio
    DirectoryIndex pages/home.html

    <Directory "/var/www/html">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
        DefaultType none  # ðŸ”¹ Evita que Apache asigne text/html por defecto
    </Directory>

    # âœ… ConfiguraciÃ³n de tipos MIME para archivos estÃ¡ticos
    <IfModule mod_mime.c>
        AddType application/javascript .js
        AddType text/css .css
        AddType application/json .json
    </IfModule>

    # âœ… Asegurar el tipo MIME correcto en archivos individuales
    <FilesMatch "\.(js|mjs|css|json)$">
        ForceType application/javascript
    </FilesMatch>

    <FilesMatch "\.css$">
        ForceType text/css
    </FilesMatch>

    # âœ… ConfiguraciÃ³n CORS para archivos estÃ¡ticos
    <FilesMatch "\.(js|css|json)$">
        Header set Access-Control-Allow-Origin "*"
        Header set Access-Control-Allow-Methods "GET, OPTIONS"
    </FilesMatch>

    # âœ… ConfiguraciÃ³n CORS general
    <IfModule mod_headers.c>
        Header always set Access-Control-Allow-Origin "*"
        Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
        Header always set Access-Control-Allow-Headers "Content-Type, Authorization"
    </IfModule>

    # âœ… Manejo de preflight CORS (peticiones OPTIONS)
    RewriteEngine On
    RewriteCond %{REQUEST_METHOD} OPTIONS
    RewriteRule ^(.*)$ $1 [R=200,L]

    # âœ… Soporte para Single Page Applications (Vue, React, etc.)
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^(?!.*\.(js|css|json|png|jpg|jpeg|gif|svg|ico|woff|woff2|ttf|otf|eot|mp4|webm|ogg)).*$ /pages/home.html [L]
    </IfModule>

    # âœ… ConfiguraciÃ³n de logs de Apache
    ErrorLog /var/log/apache2/frontend-prod-error.log
    CustomLog /var/log/apache2/frontend-prod-access.log combined
</VirtualHost>
